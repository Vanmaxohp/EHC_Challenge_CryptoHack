<img width="583" alt="image" src="https://github.com/Vanmaxohp/EHC_Challenge_CryptoHack/assets/90485791/f51352fc-f2b0-4897-8905-1a9c5f0bfb5e">

Nhìn vào code, ta thấy đề bài sẽ mã hoá như sau:
- Chuyển flag thành số nguyên, sau đó là nhị phân.
- Với từng bit, lấy pow(a, (randint(2, p) * randrange(2, p, 2)) + int(bit), p), nếu bit là 1 thì số mũ lẻ, nếu bit là 0 thì số mũ chẵn
- Qua kiểm tra , biết được p = 3 mod 4 và (a | p) = -1, vậy a ko phải là thặng dư bậc 2
- Vậy ta chỉ cần check các số trong output, nếu nó là thặng dư bậc hai thì bit tương ứng sẽ là 0, ngược lại là 1, sau đó chuyển ngược lại thành byte là xong
```
Quadratic Residue * Quadratic Residue = Quadratic Residue
Quadratic Residue * Quadratic Non-residue = Quadratic Non-residue
Quadratic Non-residue * Quadratic Non-residue = Quadratic Residue
```
Viết chương trình decode:
```
#!/usr/bin/env python3

from Crypto.Util.number import *

ct = [63358379156737039351131552959178792847154983769870350470551475598833725983805, 69683817400777110036992188676634536825049146277763708513586299878398548431564, 94902125709619485749929276878626900961976749361904840346409963857169457496738, 47325378717980739741178222108975514217060842758224334911933246337306543404722, 66698328865129083091302805569702723189827449719810877334005762575789717679168, 10538250985702639609525908621292501662996420736842968016976209222581240056053, 10839477704419554475369913605427949217322049045896045091282512634647207032969, 60463180240263881245099725525258376057407613263779813884840051900342630561430, 46957468725861232692732724610977813363692073701157590902328650516331607550163, 51632847330136705116730459579557173690907919690685014202202245184778952916275, 2548991365018537861802403955640439291167376475022318301222657289826461259641, 5689606001087193164135245809676725149444876970908485059390853439551118387641, 70782997853487945680014375918369604599918888485958819599909185073112399308370, 69929160619717352983473829304331744930335856133333281316601151042495588016780, 25891117193737053747646418619122862692645616899499719850054676403187672301497, 3110458447086964325708713020366048234761974833105179402268807361436149873344, 90641430813528185423309937228901075473936028507525223170636394443987415878400, 8456834032970373098468139012556015796959343246999592101978225560591256139665, 64157571663865896417720855230159857823573640698536311362755629740964895922700, 44776922595555238180592188615211062349149454663157131390680961309128661805514, 50045099203630631444574857196590724104091658621724953432012336114972804620327, 17932018957847476896567746665155318476478926195548165256046509042427413699815, 68394085142077624324694875450068705771225724831584056379059411687166920532600, 48782690685460408840825563781570994460367556684326273540320558205309585840846, 53819459086024719792553840380857487688574502969455298868919759720452342813181, 41869421146988276165402930034848230448840861533069935282809410628921035697096, 45309349939643320351573826759816120136455317542925613237820454800052413930306, 95257837039906003528223236976331059403074782044856461327520583127929524530908, 49222143223457226839340161055628618179559621203137108107030638320256522211311, 62915903446454501659070125186716508205321324026282790085414461325630476381041, 10499129935636019764247078853904083162827784375164053051690419365994523985079, 86196869255001365179808977994683705653011240192450998360317329285839442239538, 38081149064152819948981214744907864478664968000337097873480018982745448199264, 66119398602064784352205020201392163191581362343020066250552455161740439108713, 28463162985627394469723090181321443135095716748719874426434757418086795925993, 71679074274816761461730677039388083989987435644638665114400037702260978868843, 61820166298336114438366145866656386425013072888540192893017491809092915296682, 74791262781449816228391935731986586074464630119673444113886052406414882014346, 22918036067029469476079024005196713980988300845385146912809116577360054163467, 13400738979627430476201794582258019471636804333012786737375080122098545568070, 95464194813190730999343592500046390283343816676660272028938349324082701302561, 45292220129487675631506513275066484347318195804845694036018861290901271353089, 54863762819790555190005597871600609517859285612110463371458923414457292350985, 4247891965924296691767496366143719125953811543769150024185617939005245755281, 76228481361633987867968735409863944134395546951230321856768345792795570211585, 72835477765451456098245749966016820435493714586980962205863319576297084686105, 49103027498580064609211660864998399047530982723915512698415611678521207701170, 47001711602938260552142030510792814718259706411700775913631665558607948423702, 10345348771585331519053686304826289838188999558070310202563812325320697763988, 33220244034236027916540920708775188763860283831758512667200038065041969915080, 50143226334022747367483197384538177434292691705128819844212977704008998221293, 25891020170428227972472313890635730064546072735185515500463025608602945230787, 37280943130053122317062797943269501223729536730292253708334352418906065552410, 15948471789818560929307061817093342200247822369448560850508249056703959473027, 95986484941156617639702170491842217077389767116750382833963885361011740043095, 46343581815150776807703806882414002653226671411341883763197278650740264348955, 7283741522273885220807870151020982971567637025045638623107260374079321155228, 44722160326175139831871666433988115603750217136399775274568184911250859585506, 39339492018714654626327254450149541371631462539346581446406865326561841547312, 65608849480788203148752153070873847339687273695252731525190718561265144738674, 7169441510285826808957356195807530271612909303193237125758721662295390598936, 18058230840165287621132277781777424960166866176808920327280282327578933150592, 4267053992350457359344559808669359982148731373878926695473360912019736853442, 47133549264098270321841995907959976729641424240925148961232605937026394712641, 31895664342066933829527067330191459084771309167574843168277435112767533188427, 21562148266290244916070737135844869841268292853155204121648308749864175238198, 96370597047723555618982664865080707175203772627601026303006789858266325902975, 65842944559095922651331902628813617293048337073023843365199830393934934923381, 65683786374491387914312379376362654059514158798983873297142651518262451040257, 32514469555187287211735111557083699483343114710942661985126544456549194792133, 34558891160589108262341848713654240972559769787014468479940148431001253108789, 33742975806767356359529806812173324206380147709268684207460844180559135632889, 44888510464265752995964623410822709844178657494027423940592035387034930651851, 37595546921353702773718428157629662752808263923960756499162306924203131379075, 38444120174739376399900692993468542050133425298021260200018208611018615125665, 96066333201929395983863391232574926254920212305745503733934226542147241875657, 93578798329426610966420342591872620399503687487664287821035131883236170459698, 17860414382898976317483168381889513935792738864327505288147516596197289736806, 23393807143445060446478605686213740459386864081521309868708984449092735298907, 15526995007995840913475808538774773933644205101143015803383786236831701392366, 886105211676525055885896637427553280269659391642249838093286982323692275630, 20155062459656799817753154380268411386925064229206783697584778144061722148339, 76657421802922734191081543793654189012597807904756376313126530707786694220615, 1171507769658706528145884681067457306252404327459826558497718368072699523258, 13168295116858065753315999939812875499955566390904210432679826060772756323934, 75145648899255652610033158472630273098016884722683273170327226142003593705196, 86226996715630011249362746314818210747475896003869781923210340274440673466603, 50342373657685131411506923303100105223138831701262752950574840545193742540890, 10079951878543660993601083296061809394572077700117486009544797770598956918331, 419471535580964595228815263530999113212428974039244838791324250343009354071, 77041570479869408628303731537156696763182340452910942504397809125285211080897, 5421935100416116740126071606749954933728409819194266171830465893601486790758, 68392799612859919132644423858196333464005824310262278036858819963987433277182, 38934225326422525882883747945526271715380649037062430001692877971438424454588, 57968645841287229158043183283839535444624071996663709208360584358856223250707, 18777264062495206778764478109118485766266955963905341215246734875605518329670, 91025587533764613144478569805584977691530685122511477998442621496563135354768, 47897880806624570459973687592733679385038376031825267228847967348716074239661, 60493535622540769945507213224677656012408322533321983123667293088304768266763, 34568874439574100102105641751811405773864223677790664150206438739496610465147, 44625011653640444181882576800540297456548938652534216605875194270092635459495, 18704685538486045421903894121531105417689090891245421885850579594794128652036, 14321236051434313439136096272115157624296212101106775545819270028533192990702, 83419771002443884242515702513155361597560201472589024135052620423896777677758, 10863946611886653069436346736839797089618172641106627498509238184621184979340, 77931847353775366738715314212811950365802870387257208673864425651377794339724, 75673208615571428227301140272377766192031705059633524215093677823113063848731, 56050818272715104602671962424605482667215117409232388101043547008043179176283, 74390813436335699818835733171999646858159092856397717415369074526066126796656, 69925792487740933559006560863737090016207279247062151357015310530930596951394, 16837919131258742240152472591235960911787705266244830047731486762242829625038, 61478177713458147718800617573681082132874631745896049170578021798718053363431, 73892662191532209070623952497374309114438462063132889204080987386169861221665, 85033392554981087951442256387176386394065943718323461877661700290753051048929, 2257574283012761105837573816053278602044731080022435820745944308681704717238, 54443692674901468752143244413210271810595022854896920520777671769785354330144, 49379716012707404658079898897369198984257630239886659274531591685988456973610, 86847043457827962489177246047626657337402722297214571074761367603877777989908, 65565184434947272490063492344663321844596978924391145856638527949682818708438, 91448648354842700860434592816793228192329722947154430836820029235958440194577, 12173475485853993823598921722881761476297235653469393513730634228629996277040, 64124194882612762318064145112090713005819875393475689293889463521443346035789, 59009321705863460920147645126820436092743977348091158261436447578471513334280, 71092216517718321005991118138859375808139915487181666208527970935340831143104, 39913229146115926143112032969076375155365917117565726453355778045254564113611, 87419188920266643207887307542133307467049014118431066597913432893093797362909, 64371103064711619519363623356963591355785343353929236321841693034391184876641, 67491605898993596497110660153126774073478778543639534449547975121337626151835, 23896120857413542144780956194901482277018711410350521188800379290685210564463, 73017416828200822523102992412078440330281391492280591519487529903970399937770, 7398989697714180472916624647105061275381942126081074915224766551775989541173, 94444946016544438727434699532612112728767432064902500731012808452898216131514, 72472142518244224918608681629973175182889746598995710597844349071602492959077, 32908810875463470239814181001844034532706243165308918975200684463229674645614, 55246406579455578573939517844622685075025693209251714916033808329061146531792, 4283900235590887800398662348989626236820141696696421348667455377543702832642, 58953587343327314321419989901645344378245661222274971758121145629024445608886, 77940687840048903077726877410159015406136331231365093947046900288697036814193, 79384507888454634156220195839554286983811994595480586238580388674627463241091, 92338303584124232303911520381143477462693479742947657866729405293190441402656, 69818436769234495398500366131303532494412678328582334554333684285228025069856, 84158888971712209429404307308352881819406788085572778181894238617446814856292, 74827985866750117005400521231437970479456522878495579920600641950222766603858, 25819941976903116533575626541602290180552016165704962227576082023508304856893, 34948764952747542305662207630496462642599657809650523352540584718421626549227, 24921750255823345369724454465308218107199792825115201799486998069391536777328, 67509779307685940886595408151488068841503723637012737433150140160449742746199, 31037572597082115543353731612696157325231768894570216586815776868275635436795, 54979672450101202850460594083715088858893941119133934971721447356705555160115, 70685559093874462782323953142920817071646056306938768153291803048908650632954, 29421943074050064578052184481152248242534191883652104683007592422212271971106, 34411741452601065822096867070821551277705139532331749358130169368396255632215, 90247464744818725514836920241915767417071146055894133056692093786691487028098, 47575926734164469865669551721942627254642838071455114096104359865564347460160, 30606850797426926514617639331817125338652236288732575304519440017833923650715, 8353272181186426774234004832827486935283099279504300527537764803530618140069, 20509871656643106614331472388965500752794904787758747807303001842490511728189, 26251966720412999723230290917611976357897623844091113259821595804485429536504, 87240862461135134310256563136737292518400315839303588958842697765981203867845, 85039934724708303940609783961074911873742689698032328421127809178073440257426, 50379040848815670406226545261543625512855614069180914322438752150700773308920, 27943037092670625555036224772255649670008685186942232465433584671068420913192, 47162923014063224566413313007774671707731247809679772108200711226572115061369, 67228957661647893943622621321326010906573441694512961976017511437878247324581, 17119128515488146751787145580468711750218333490540158673867771986874043196053, 14570295989055372321464109434848468745137288972880138567641213983194889035875, 2910857840444719192326196551742445416495707130121657886598934377143968667910, 93096713525512551289307954443523385107264672060472124690387268070537116181863, 42600338748206624806182765083127720683553905155477992939386448671205987718730, 28912343936075617891577077041003211910696148691930296947529682294564204274284, 29659069821983573322771117573919877551980862457239537060896152314750027017884, 70119190560711676800834553395028031369703908382763654109926042722011333801497, 29551421904964674900812497361347211768845039305873077147055536483126514656827, 33018094027260694990261180324963231580479730586110130836493253243092174925854, 24375879487320563723819405480284958234929395963034131979600482923322966697245, 64231275961319943922224263994714913142668675880227337717609243637081181282271, 29446370471867056772840708750355857586428304140035438439821164771878461526686, 83116579757667523523876177498645805937985286464400971237209565828715909405699, 13241139960242363042657672423086609707766552686054413021700123696075631773851, 5476837476114222931219953430793458790229730657707859308012532754506776944727, 5172669178993664787208030600486637086325833471694459935529906408184461960034, 53243802767235718410265976865468988000796707554205873254015259693533492437485, 63152501525937830621999684636447988845262937016081004880910303178752771833789, 75714035148414858434014329700931523133249964631394039089621699093100266743034, 43782343136368758015387277644101769794333676967481154550464612659395018211733, 46224529540613780488776246843037002702717332525071232828374002452278137197013, 83482159685375155405339698522547420481883354212547403617959263380221915155264, 14889171910797187038844731094171918809933465674580657648496115528643646326194, 79382867467421714026545993894471307547105668654974981151188812386113356593813, 56796510962846493550383065491662603471364084771170794015451819799709408751115, 31863347343767928613084827154649338079134370193262279879568255801499436063056, 11253905625660254264397698381220624711689176167599475322625941050917161293205, 25923602547830187815639594698448507432245463163955728488111906160476522869757, 24711620941131229078891282343180190775350410576195989129612646814825735510779, 64641845007951384996576420068071330823384364181554466582286800443007541918518, 11613824815742716694080497898802327436832447169302536573623289209730415868311, 40344408713341869856146645799921396135768281772116762415753922396410217503432, 34414496010687308419986219993757016504443848047224750381098137925131374373323, 71897883008617034343978200789715219290785981845171623132020306949777173885524, 1112845222894736882442769432939898541691435872230602321167492018199140756360, 44718719968223947693494095604154413154651345700146724424143118146178020914852, 62206833214355813118499660176144081459860749507422651039002954389242080920867, 24467006779251266342641050648970512396036911892481005151702068371056022600350, 85142484537978161787734771728947310965313169063661901047937096074716256325206, 25476621852052468391363094863710661427698469821894310295208565554769806238584, 69747059626977036542446695947350875409886311379947390771344587550572436327184, 53149656063230989006973532323529773337759608403862349868888147802748943840180, 69743376428553846981311443256323162324295143227571097218009622106274171654183, 19806763759307115749319822786745752488427307340039420688059949338298164099639, 22842991753208159147365301123132468974329362352762495365907106766345231437844, 93024914968210549785593507380081233023066475842000193811502611780572198038754, 903975667163429404467095420825707216813103477617700853920053374858325239330, 51277256319401959484622625706451672124290516633572373722477998490986004347256, 91890712005907127511608234265894278230640830112529029370655529939504182519611, 95784134021783193001938231277380342555209399903909350645973271925488960845354, 62867659767781032507891205015377774351950716444796478176463344974103069258641, 73573207095728350546265012073394382845313497114259988253010200109675688247089, 17336152221334996832949203580308275182496740295141484161930961537186988009330, 4994735060475452287578192998048874467626337011512382997734579257090325470558, 94727552666985351641353741421060892437096074843909135219216879624839391953226, 8129685671264460026255876079436473449794390890580991696246872012167818990207, 3258677037329405449384803271876439892451235480605151641691272896373404679948, 51728466062631756317336833441695803817753516111501847795729546335233779258086, 20654727071062067104792073221855180066529856423368278699027469037350839966442, 90328568244576475491575228417675151799384212024447246693301863424033122038437, 94741927581751686523979625195218751987314566799343478515694016463929163165062, 54162620658362538981694741425421493028493722540870213806755236157911786483367, 48403674938503263033607098044214299207925695320659711143956760691547870398815, 39070274516309976252956713038661038266621203867816292484122400302841499432272, 21162714960615105256944328590889075767289986310771272389079901175195705744565, 11662683407062149478637629395264517153783637529372961965964043692724499699372, 58116597622197972424812408430041689946525821662147485427785631258095184704375, 31381648277376907333461505521190095742181326869693163864928310492622140577527, 9005454664030151496715222179628333908980872673435403903028446130350118289882, 31373074589119696764591028582553130061515610776864900518249273821769264783031, 5716116742108838492671093248198480979724558694765379513687605546819045694432, 18400192909959468445357119044686229953308446197584056525065072561812706457822, 31370815303594613596457562411589553908084015540632655695835270921750889943787, 70100486701253400332598459731392718957837544082878174170803872832388061090190, 72543313857218849281504599976140401950148897761924387000320087065224116915908, 58977926636985399516756356845170536556767037175824396608759014945392606644011, 11438792039826314333934943955670036906396992211552000241674308989826962136424, 3307879976527577986674596169583546609903196334023446813718730914560333028500, 9681239835406318921343451432319928159201438511668672541823415547643091686177, 80544125680840565583585919567673942184325365691364511520254293968898547696017, 8477544478478332700092526229164623655730467464674243077956088724923045314509, 34038743524630855501196182092095054283359025349011363037846880689263010937880, 6435540223036204151555036754387078905190008382304058310632077771520324158210, 14226528567675933847133174581444477959660279766119168767275891878186148365329, 80301172490895277008612517916888333276155698461364380201949711694154479299372, 41520665375303063601382154785451450546301915719974362938555537060856174850945, 55579133461300691053760523605640780415748489204395637727029727284150150581442, 42164903172907219161182203688912460377801505544809406244560718674049601441198, 21520154433178840463209978616052423834092816629627509986927025781504852412745, 11616750580988578304891501805710072156248221267026871261335958456924030166845, 32364808723754500091676610922856115039686517775087149829762270996814522716182, 43274616266303286175141712975628858517356010742895421728501246285294012340831, 43805304807510765666965771468448751137703153628108443956480978988159296611945, 65296569565278632014065848621503349619897956293846161466879543457369779400292, 88200906469553870958631476973866427456954138574626321037714258329767100024590, 63820613051056407677800791996439231002048715250141406039384204463223071377162, 94665114274422234483450441669961037738124957057447837844708886570071219914022, 30965706855111926353307710302044017713792358844965192942573125468024705073100, 65606242773023740234314279408232668891646219055582456203601804151431112088901, 35067861402880111436041083793717108633463647140610654605735562184793355166684, 44910274874980520826167484521975442333832326067841567988873973528158601718018, 35213994388742695663342749656810760331982190900211102927059567645926182435853, 39379557647649022393231095201535132866113885299916091163971733410936363934336, 7197205900015692999415653558558039444935821491582841744369436935327722857366, 27752816213711606843900029894278149332096882314305117994598836997520231838070, 38873167190343991034457784969306194566486030337432979110458369418103936141160, 50990951959730866038441987651056308264409421481432615199525478156123006823391, 83870449637855202980864057957310943806962553806763430611947713296948420673379, 14674646123636777972328842912230568303187763610579843909851307035428687265520, 31855035971685378572303311324029232111637813447315423931941961006878830498798, 1870597212544872048334050313365027502090356838458074541406844819938106373732, 39865035633199671872904459539499329909628329400491866835932955788253674090276, 28284957755350784931886951112785139847674780881252229517119454640000072113414, 36909705691193287102286337471658612686658120930662568451323834981758440061286, 19942643716865627087116888508998154979928426039912073653418541155262504986892, 46728676909786989442796336642433560753826115892703122969270404152267748811875, 57859928392816331188436397028337019286862954037614848624077478216523763691875, 53709514134972671454399738823792916387708974110596680838012690785487716434172, 26656292975704641157446797323141580400341565467064941870784717640551164693841, 87502600445863165023905301908873929564585049462500570071972071838347981408736, 27165057089172130356704470538559846445622695976605688998698442321360403193991, 24429861962034043068313007339782207794147108403975060980869750745378649598323, 36012155390654826644950948624115066935617240449236898060031166383052648578259, 66761282373761189999925693536357366038394080245392682849381871594457489867240, 95076818005142605726742885149282244009686559754308301292724058253536711423792, 83482773184485902649683356882057806824651623069081442254310201017104037748658, 62987371394547811936777198735919161620084787613600980723678602009535961202647, 79820325977006386848447920525696626177121899080189047901459646095877440686054, 20408628236279041065766450435344773821655268267220137923525906342587008084900, 32453428090863461355577739734679482915682538305439381413650830518859316679902, 62412924089647554912766015548307913224055155981894082890978768203015836215667, 87753467612508745690082754290635269277599985424324542214916818413452717761951, 76475309468639403093657983149975839711528900850082440086435996920908727839248, 16408923811508780931816653755890873079969212178155839592526674624761551343275, 31361335385272625865244267234390657775484556421467979881436087420241795138845, 1539211559376037693662784171258036252641461497430607323125295262709664247372, 49851468408927402946774826855744359943076895588648476260699554816434154109910, 78126338119193302701368945452340630437024659820652255956502278581022298068609, 66834853503589318482604528083410114253005077266969121711559029373614527616331, 90398938129487458978007010505727110959273598686987782400289335986565596149943, 33143549414734799858383236598696811184190559023339912314257105639514354288184, 83842293803657066884381741198283510706930954104514370275561472094982363629995, 77572968770616594604222161729724280565984553997845522641153268115857278827484, 40743663274232571219205399992693398478736921083062830255468576383015074354736, 15916188880215287678000605057952149076734628143515530251398540703995926686400, 35370280313384050079570808488362740979354915900276941459116895433522631050195, 75701038498654045275210346335070030894646222886066466205379625820517580923132, 83444880763027916943988683952147988817745077764852572147750393619998963129751, 9125120923779515450908403317961123641673952612445964348474394908693872783887, 94929294495954198249302663467189948711998502538919460877028654233303395875550, 4172472366745364531210007146407816013965196374173740074185849771499558044154, 60836665608359179811491451344543195652994126338297783083393941330233351644709, 2633134037607655265662529538606109467799948972410166703163545160611552663298, 25607743537305477649294615322872992499070444705625696982793218419429415981422]
p = 96517490730367252566551196176049957092195411726055764912412605750547823858339
a = 1337

res = ''
for x in ct:
    c = pow(x, (p-1)//2, p)             #Ky hieu Legendre
    if c == 1:
        res += "0"                      #Neu la thang du bac hai
    else:                           
        res += "1"                      #Neu khong phai

print(long_to_bytes(int(res, 2)))       #Chuyen tu so nguyen thanh byte
```
